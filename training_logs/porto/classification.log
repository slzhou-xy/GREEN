[main_cls.py:55 <module>()] -> =================================
[main_cls.py:56 <module>()] -> is_resume = False
is_cls = True
seed = 42
device = cuda:2
dataset = porto
grid_special_tokens = {'padding_token': 0, 'cls_token': 1}
road_special_tokens = {'padding_token': 0, 'cls_token': 1, 'mask_token': 2}
mask_length = 2
mask_ratio = 0.2
grid_size = 100
grid_num = 0
road_num = 0
road_type = 0
batch_size = 128
training_epochs = 30
training_lr = 0.0001
bad_patience = 5
warm_up_epoch = 10
warmup_lr_init = 1e-06
lr_min = 1e-06
weight_decay = 0.0001
hidden_emb_dim = 256
pe_dropout = 0.1
out_emb_dim = 128
grid_in_channel = 3
grid_out_channel = 64
grid_trm_head = 4
grid_trm_dropout = 0.1
grid_trm_layer = 2
grid_ffn_dim = 1024
g_fea_size = 0
g_heads_per_layer = [4, 4, 4]
g_dim_per_layer = [256, 256, 256]
g_num_layers = 3
g_dropout = 0.1
road_trm_head = 4
road_trm_dropout = 0.1
road_trm_layer = 4
road_ffn_dim = 1024
inter_trm_head = 2
inter_trm_dropout = 0.1
inter_trm_layer = 2
inter_ffn_dim = 512
tuning_all = True
prediction_length = 5
min_lon = -8.68942
min_lat = 41.13934
max_lon = -8.55434
max_lat = 41.18586
cls_num = 3
[main_cls.py:57 <module>()] -> =================================
[multi_cls_trainer.py:167 train()] -> [Epoch 0/30] [Train loss: 1.0764568055] [Micro_f1: 0.5606608587] [Macro_f1: 0.5073475980]
[multi_cls_trainer.py:171 train()] -> [Epoch 0/30] [Eval  loss: 0.7539118108] [Micro_f1: 0.6898877779] [Macro_f1: 0.6295399139]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 1/30] [Train loss: 0.5706174443] [Micro_f1: 0.7688983083] [Macro_f1: 0.7158901166]
[multi_cls_trainer.py:171 train()] -> [Epoch 1/30] [Eval  loss: 0.4978610623] [Micro_f1: 0.8033131255] [Macro_f1: 0.7502104010]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 2/30] [Train loss: 0.4902149669] [Micro_f1: 0.8046707434] [Macro_f1: 0.7561223194]
[multi_cls_trainer.py:171 train()] -> [Epoch 2/30] [Eval  loss: 0.4675867727] [Micro_f1: 0.8153715157] [Macro_f1: 0.7645270105]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 3/30] [Train loss: 0.4680175968] [Micro_f1: 0.8148103456] [Macro_f1: 0.7690341862]
[multi_cls_trainer.py:171 train()] -> [Epoch 3/30] [Eval  loss: 0.4565987868] [Micro_f1: 0.8197461875] [Macro_f1: 0.7770409535]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 4/30] [Train loss: 0.4555340717] [Micro_f1: 0.8211361249] [Macro_f1: 0.7776610727]
[multi_cls_trainer.py:171 train()] -> [Epoch 4/30] [Eval  loss: 0.4461062472] [Micro_f1: 0.8262674056] [Macro_f1: 0.7850536829]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 5/30] [Train loss: 0.4469250960] [Micro_f1: 0.8257963310] [Macro_f1: 0.7842146032]
[multi_cls_trainer.py:171 train()] -> [Epoch 5/30] [Eval  loss: 0.4434177599] [Micro_f1: 0.8281743138] [Macro_f1: 0.7861285165]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 6/30] [Train loss: 0.4398151429] [Micro_f1: 0.8292617431] [Macro_f1: 0.7889853769]
[multi_cls_trainer.py:171 train()] -> [Epoch 6/30] [Eval  loss: 0.4405053655] [Micro_f1: 0.8294438864] [Macro_f1: 0.7895178763]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 7/30] [Train loss: 0.4340240905] [Micro_f1: 0.8327560479] [Macro_f1: 0.7938533147]
[multi_cls_trainer.py:171 train()] -> [Epoch 7/30] [Eval  loss: 0.4387555492] [Micro_f1: 0.8301729984] [Macro_f1: 0.7920942115]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 8/30] [Train loss: 0.4289031127] [Micro_f1: 0.8353002961] [Macro_f1: 0.7974340101]
[multi_cls_trainer.py:171 train()] -> [Epoch 8/30] [Eval  loss: 0.4376243636] [Micro_f1: 0.8310397748] [Macro_f1: 0.7922802523]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 9/30] [Train loss: 0.4245066534] [Micro_f1: 0.8367398273] [Macro_f1: 0.7995333605]
[multi_cls_trainer.py:171 train()] -> [Epoch 9/30] [Eval  loss: 0.4382944870] [Micro_f1: 0.8318606631] [Macro_f1: 0.7925595375]
[multi_cls_trainer.py:167 train()] -> [Epoch 10/30] [Train loss: 0.4132545567] [Micro_f1: 0.8425132481] [Macro_f1: 0.8073542684]
[multi_cls_trainer.py:171 train()] -> [Epoch 10/30] [Eval  loss: 0.4397641220] [Micro_f1: 0.8330435581] [Macro_f1: 0.7951148830]
[multi_cls_trainer.py:167 train()] -> [Epoch 11/30] [Train loss: 0.4030478512] [Micro_f1: 0.8474062945] [Macro_f1: 0.8140490293]
[multi_cls_trainer.py:171 train()] -> [Epoch 11/30] [Eval  loss: 0.4373164947] [Micro_f1: 0.8338338542] [Macro_f1: 0.7967240863]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 12/30] [Train loss: 0.3945936855] [Micro_f1: 0.8509736805] [Macro_f1: 0.8190104858]
[multi_cls_trainer.py:171 train()] -> [Epoch 12/30] [Eval  loss: 0.4337087480] [Micro_f1: 0.8350218479] [Macro_f1: 0.7962300322]
[multi_cls_trainer.py:95 save_model_with_epoch()] -> Saved model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:167 train()] -> [Epoch 13/30] [Train loss: 0.3837051794] [Micro_f1: 0.8563137124] [Macro_f1: 0.8261604619]
[multi_cls_trainer.py:171 train()] -> [Epoch 13/30] [Eval  loss: 0.4395409315] [Micro_f1: 0.8368165850] [Macro_f1: 0.7984955606]
[multi_cls_trainer.py:167 train()] -> [Epoch 14/30] [Train loss: 0.3738929736] [Micro_f1: 0.8602550027] [Macro_f1: 0.8314827511]
[multi_cls_trainer.py:171 train()] -> [Epoch 14/30] [Eval  loss: 0.4447334136] [Micro_f1: 0.8354807295] [Macro_f1: 0.7969077186]
[multi_cls_trainer.py:167 train()] -> [Epoch 15/30] [Train loss: 0.3634073800] [Micro_f1: 0.8653672929] [Macro_f1: 0.8384366647]
[multi_cls_trainer.py:171 train()] -> [Epoch 15/30] [Eval  loss: 0.4543448958] [Micro_f1: 0.8352767821] [Macro_f1: 0.7977210405]
[multi_cls_trainer.py:167 train()] -> [Epoch 16/30] [Train loss: 0.3532018569] [Micro_f1: 0.8698167529] [Macro_f1: 0.8444288769]
[multi_cls_trainer.py:171 train()] -> [Epoch 16/30] [Eval  loss: 0.4560338137] [Micro_f1: 0.8347975057] [Macro_f1: 0.7974759102]
[multi_cls_trainer.py:167 train()] -> [Epoch 17/30] [Train loss: 0.3419034260] [Micro_f1: 0.8746146237] [Macro_f1: 0.8508932693]
[multi_cls_trainer.py:171 train()] -> [Epoch 17/30] [Eval  loss: 0.4689001329] [Micro_f1: 0.8345323741] [Macro_f1: 0.7954569725]
[multi_cls_trainer.py:189 train()] -> Best model at [epoch 12]!
[multi_cls_trainer.py:108 load_model_with_epoch()] -> Loaded model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/multi_cls/cls_best.pth
[multi_cls_trainer.py:256 test()] -> [Multi CLS Test] [Micro_f1: 0.8345884596] [Macro_f1: 0.7961876244]
