[main_tte.py:51 <module>()] -> =================================
[main_tte.py:52 <module>()] -> is_resume = False
is_cls = True
seed = 42
device = cuda:2
dataset = porto
grid_special_tokens = {'padding_token': 0, 'cls_token': 1}
road_special_tokens = {'padding_token': 0, 'cls_token': 1, 'mask_token': 2}
mask_length = 2
mask_ratio = 0.2
grid_size = 100
grid_num = 0
road_num = 0
road_type = 0
batch_size = 128
training_epochs = 30
training_lr = 0.0001
bad_patience = 5
warm_up_epoch = 10
warmup_lr_init = 1e-06
lr_min = 1e-06
weight_decay = 0.0001
hidden_emb_dim = 256
pe_dropout = 0.1
out_emb_dim = 128
grid_in_channel = 3
grid_out_channel = 64
grid_trm_head = 4
grid_trm_dropout = 0.1
grid_trm_layer = 2
grid_ffn_dim = 1024
g_fea_size = 0
g_heads_per_layer = [4, 4, 4]
g_dim_per_layer = [256, 256, 256]
g_num_layers = 3
g_dropout = 0.1
road_trm_head = 4
road_trm_dropout = 0.1
road_trm_layer = 4
road_ffn_dim = 1024
inter_trm_head = 2
inter_trm_dropout = 0.1
inter_trm_layer = 2
inter_ffn_dim = 512
tuning_all = True
prediction_length = 5
min_lon = -8.68942
min_lat = 41.13934
max_lon = -8.55434
max_lat = 41.18586
cls_num = 3
[main_tte.py:53 <module>()] -> =================================
[tte_trainer.py:174 train()] -> [Epoch 0/30] [Train loss: 29.0718168870] [MAE: 3.2658917904] [RMSE: 5.3751822152] [MAPE: 0.3597579896] 
[tte_trainer.py:178 train()] -> [Epoch 0/30] [Eval  loss: 13.6370228516] [MAE: 1.9372404814] [RMSE: 3.6918629843] [MAPE: 0.1969261169]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 0, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 1/30] [Train loss: 8.9562226376] [MAE: 1.6762233973] [RMSE: 2.9926846641] [MAPE: 0.1819051504] 
[tte_trainer.py:178 train()] -> [Epoch 1/30] [Eval  loss: 7.2682362786] [MAE: 1.4756768942] [RMSE: 2.6961872837] [MAPE: 0.1568259001]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 1, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 2/30] [Train loss: 7.1463475836] [MAE: 1.5466897488] [RMSE: 2.6732727321] [MAPE: 0.1691070646] 
[tte_trainer.py:178 train()] -> [Epoch 2/30] [Eval  loss: 6.6541296617] [MAE: 1.4866935015] [RMSE: 2.5796290779] [MAPE: 0.1648365110]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 2, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 3/30] [Train loss: 6.7419176512] [MAE: 1.5073915720] [RMSE: 2.5965209316] [MAPE: 0.1649687290] 
[tte_trainer.py:178 train()] -> [Epoch 3/30] [Eval  loss: 6.3819634141] [MAE: 1.4740074873] [RMSE: 2.5263603927] [MAPE: 0.1654956490]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 3, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 4/30] [Train loss: 6.5215142631] [MAE: 1.4850813150] [RMSE: 2.5537504292] [MAPE: 0.1625178158] 
[tte_trainer.py:178 train()] -> [Epoch 4/30] [Eval  loss: 6.5628698583] [MAE: 1.4082250595] [RMSE: 2.5618679849] [MAPE: 0.1408304274]
[tte_trainer.py:174 train()] -> [Epoch 5/30] [Train loss: 6.3815967493] [MAE: 1.4697741270] [RMSE: 2.5261232238] [MAPE: 0.1608018428] 
[tte_trainer.py:178 train()] -> [Epoch 5/30] [Eval  loss: 6.3283211411] [MAE: 1.4144357443] [RMSE: 2.5158755729] [MAPE: 0.1466380656]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 5, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 6/30] [Train loss: 6.2693057861] [MAE: 1.4590287209] [RMSE: 2.5038946333] [MAPE: 0.1597877294] 
[tte_trainer.py:178 train()] -> [Epoch 6/30] [Eval  loss: 6.5031492628] [MAE: 1.3876312971] [RMSE: 2.5503996816] [MAPE: 0.1404791176]
[tte_trainer.py:174 train()] -> [Epoch 7/30] [Train loss: 6.1837157854] [MAE: 1.4493199587] [RMSE: 2.4866744622] [MAPE: 0.1587429941] 
[tte_trainer.py:178 train()] -> [Epoch 7/30] [Eval  loss: 6.3579514835] [MAE: 1.3894881010] [RMSE: 2.5216269597] [MAPE: 0.1458576918]
[tte_trainer.py:174 train()] -> [Epoch 8/30] [Train loss: 6.1136989160] [MAE: 1.4428284168] [RMSE: 2.4725768934] [MAPE: 0.1581069827] 
[tte_trainer.py:178 train()] -> [Epoch 8/30] [Eval  loss: 6.2550765053] [MAE: 1.3943545818] [RMSE: 2.5012243134] [MAPE: 0.1480191201]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 8, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 9/30] [Train loss: 6.0731974052] [MAE: 1.4384855032] [RMSE: 2.4644232390] [MAPE: 0.1575842649] 
[tte_trainer.py:178 train()] -> [Epoch 9/30] [Eval  loss: 6.3014589764] [MAE: 1.4238600731] [RMSE: 2.5103237615] [MAPE: 0.1462860554]
[tte_trainer.py:174 train()] -> [Epoch 10/30] [Train loss: 5.8681337851] [MAE: 1.4151309729] [RMSE: 2.4223528975] [MAPE: 0.1549388766] 
[tte_trainer.py:178 train()] -> [Epoch 10/30] [Eval  loss: 6.2108699439] [MAE: 1.4937714338] [RMSE: 2.4922518826] [MAPE: 0.1629458815]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 10, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 11/30] [Train loss: 5.6944630795] [MAE: 1.3991831541] [RMSE: 2.3862883684] [MAPE: 0.1533320844] 
[tte_trainer.py:178 train()] -> [Epoch 11/30] [Eval  loss: 6.0659263800] [MAE: 1.3858932257] [RMSE: 2.4630653507] [MAPE: 0.1508183032]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 11, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 12/30] [Train loss: 5.5243975973] [MAE: 1.3842695951] [RMSE: 2.3503950396] [MAPE: 0.1519588679] 
[tte_trainer.py:178 train()] -> [Epoch 12/30] [Eval  loss: 6.1191310658] [MAE: 1.3950152397] [RMSE: 2.4739674351] [MAPE: 0.1488180757]
[tte_trainer.py:174 train()] -> [Epoch 13/30] [Train loss: 5.3618945216] [MAE: 1.3702287674] [RMSE: 2.3155955654] [MAPE: 0.1506896615] 
[tte_trainer.py:178 train()] -> [Epoch 13/30] [Eval  loss: 6.0564758404] [MAE: 1.3870067596] [RMSE: 2.4610925050] [MAPE: 0.1539373696]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 13, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 14/30] [Train loss: 5.1689635818] [MAE: 1.3547585011] [RMSE: 2.2735565259] [MAPE: 0.1493268311] 
[tte_trainer.py:178 train()] -> [Epoch 14/30] [Eval  loss: 6.1459015466] [MAE: 1.3792285919] [RMSE: 2.4791404231] [MAPE: 0.1484166235]
[tte_trainer.py:174 train()] -> [Epoch 15/30] [Train loss: 4.9801486559] [MAE: 1.3366690874] [RMSE: 2.2316379456] [MAPE: 0.1477964967] 
[tte_trainer.py:178 train()] -> [Epoch 15/30] [Eval  loss: 6.0574902142] [MAE: 1.3548966646] [RMSE: 2.4612141772] [MAPE: 0.1447349638]
[tte_trainer.py:174 train()] -> [Epoch 16/30] [Train loss: 4.8108847452] [MAE: 1.3243579865] [RMSE: 2.1931142424] [MAPE: 0.1469023228] 
[tte_trainer.py:178 train()] -> [Epoch 16/30] [Eval  loss: 6.2023302659] [MAE: 1.4085341692] [RMSE: 2.4904502625] [MAPE: 0.1536804289]
[tte_trainer.py:174 train()] -> [Epoch 17/30] [Train loss: 4.6462572066] [MAE: 1.3084816933] [RMSE: 2.1555394647] [MAPE: 0.1455473006] 
[tte_trainer.py:178 train()] -> [Epoch 17/30] [Eval  loss: 5.9713551202] [MAE: 1.3642339706] [RMSE: 2.4435116898] [MAPE: 0.1452354193]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 17, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 18/30] [Train loss: 4.4678838945] [MAE: 1.2932505608] [RMSE: 2.1137452242] [MAPE: 0.1442884952] 
[tte_trainer.py:178 train()] -> [Epoch 18/30] [Eval  loss: 6.0258123739] [MAE: 1.3490436077] [RMSE: 2.4548158103] [MAPE: 0.1425056159]
[tte_trainer.py:174 train()] -> [Epoch 19/30] [Train loss: 4.3234627696] [MAE: 1.2799117565] [RMSE: 2.0792935177] [MAPE: 0.1432441026] 
[tte_trainer.py:178 train()] -> [Epoch 19/30] [Eval  loss: 6.0008224277] [MAE: 1.3658573627] [RMSE: 2.4497572993] [MAPE: 0.1470533162]
[tte_trainer.py:174 train()] -> [Epoch 20/30] [Train loss: 4.1853411615] [MAE: 1.2669173479] [RMSE: 2.0458240869] [MAPE: 0.1423278451] 
[tte_trainer.py:178 train()] -> [Epoch 20/30] [Eval  loss: 5.9582608727] [MAE: 1.3471510410] [RMSE: 2.4411084779] [MAPE: 0.1427625269]
[tte_trainer.py:102 save_model_with_epoch()] -> Best epoch is 20, save model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:174 train()] -> [Epoch 21/30] [Train loss: 4.0463402963] [MAE: 1.2542917728] [RMSE: 2.0115522297] [MAPE: 0.1414236426] 
[tte_trainer.py:178 train()] -> [Epoch 21/30] [Eval  loss: 6.0248754990] [MAE: 1.3773577213] [RMSE: 2.4546461309] [MAPE: 0.1483851522]
[tte_trainer.py:174 train()] -> [Epoch 22/30] [Train loss: 3.9330399416] [MAE: 1.2440412045] [RMSE: 1.9832004465] [MAPE: 0.1406164914] 
[tte_trainer.py:178 train()] -> [Epoch 22/30] [Eval  loss: 6.0608361015] [MAE: 1.3873902559] [RMSE: 2.4618939191] [MAPE: 0.1519199014]
[tte_trainer.py:174 train()] -> [Epoch 23/30] [Train loss: 3.8337021647] [MAE: 1.2344305515] [RMSE: 1.9579977059] [MAPE: 0.1399132609] 
[tte_trainer.py:178 train()] -> [Epoch 23/30] [Eval  loss: 6.0238618779] [MAE: 1.3524260521] [RMSE: 2.4545457941] [MAPE: 0.1445961446]
[tte_trainer.py:174 train()] -> [Epoch 24/30] [Train loss: 3.7500823628] [MAE: 1.2246466875] [RMSE: 1.9365002298] [MAPE: 0.1392062902] 
[tte_trainer.py:178 train()] -> [Epoch 24/30] [Eval  loss: 6.0033330595] [MAE: 1.3528193235] [RMSE: 2.4503050712] [MAPE: 0.1441476494]
[tte_trainer.py:174 train()] -> [Epoch 25/30] [Train loss: 3.6877301014] [MAE: 1.2185508013] [RMSE: 1.9203694347] [MAPE: 0.1387661099] 
[tte_trainer.py:178 train()] -> [Epoch 25/30] [Eval  loss: 6.0244898181] [MAE: 1.3500469923] [RMSE: 2.4547141207] [MAPE: 0.1434641182]
[tte_trainer.py:196 train()] -> Best model at [epoch 20]!
[tte_trainer.py:116 load_model_with_epoch()] -> Loaded model at ./log/porto/exp_bs128_inter2_epoch30_2e-4_cls_2grid_2_0.2ratio/tte/tte_best.pth
[tte_trainer.py:261 test()] -> [Travel Time Estimation Test] [MAE: 1.3524341583] [RMSE: 2.4457562809] [MAPE: 0.1434603333]
